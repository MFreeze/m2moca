% {{{ PACKAGES
% {{{ ENCODAGE ET POLICE
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage[french]{babel}
\usepackage{eurosym}
% }}}

% {{{ FIGURES
\usepackage{graphicx}
\usepackage{subfig}
% }}}

% {{{ INSERTION DE CODE
\usepackage{moreverb}
% }}}

% {{{ INSERTION DE PDF
\usepackage{pdfpages}
% }}}

% {{{ RÉDUCTION DES MARGES
%\usepackage{fullpage}
\usepackage[top=2.5cm, bottom=2.5cm, left=3.5cm, right=3.5cm]{geometry}
\usepackage{fancyhdr}
% }}}

% {{{ MATHÉMATIQUES
\usepackage[fleqn]{amsmath}
\usepackage{amsthm}
\usepackage{bbm}
\usepackage{amssymb}
\usepackage{stmaryrd}
% }}}

% {{{ GRAPHES
\usepackage{tikz}
\usepackage{pgf}
\usetikzlibrary{arrows,automata,shapes}
% }}}

% {{{ RESEAUX DE pETRI
\usetikzlibrary{petri}
% }}}

% {{{ ARBRES
\usetikzlibrary{trees}
% }}}

% {{{ DIAGRAMME DE GANTT
\usepackage{pgfgantt}
% }}}

% {{{ ALGORITHMES
\usepackage{algorithm}
\usepackage[noend]{algpseudocode}
\usepackage{ifthen}
%\usepackage{algorithmic}
%\usepackage{algorithmicx}
% }}}
% }}}

% {{{ NEWTHEOREM
% {{{ THÉORÈMES, lEMMES -- NUMÉROTATION PERSONNALISÉE
\theoremstyle{plain}
\newtheorem{thrm}{Théorème}[section]
\newtheorem{lemma}{Lemme}[subsection]
\newtheorem{corol}{Corollaire}[section]
% }}}

% {{{ THÉORÈMES, lEMMES -- NUMÉROTATION CLASSIQUE
\newtheorem{nthrm}{Théorème}
\newtheorem{nlemma}{Lemme}
\newtheorem{ncorol}{Corollaire}
\newtheorem{npb}{Problème}
% }}}

% {{{ THÉORÈMES, lEMMES -- NON NUMÉROTÉS
\newtheorem*{thrm*}{Théorème}
\newtheorem*{lemma*}{Lemme}
\newtheorem*{corol*}{Corollaire}
% }}}

% {{{ DÉFINITIONS, pROPRIÉTÉS -- NUMÉROTATION PERSONNALISÉE
\theoremstyle{definition}
\newtheorem{df}{Définition}[subsection]
\newtheorem{prop}{Propriété}[subsection]
\newtheorem{conj}{Conjecture}[subsection]
% }}}

% {{{ DÉFINITIONS, pROPRIÉTÉS -- NUMÉROTATION CLASSIQUE
\newtheorem{ndf}{Définition}
\newtheorem{nprop}{Propriété}
\newtheorem{nconj}{Conjecture}
% }}}

% {{{ DÉFINITIONS, pROPRIÉTÉS -- NON NUMÉROTÉS
\newtheorem*{df*}{Définition}
\newtheorem*{prop*}{Propriété}
\newtheorem*{conj*}{Conjecture}
% }}}

% {{{ AUTRES -- NUMÉROTATION PERSONNALISÉE
\theoremstyle{remark}
\newtheorem{note}{Note}[subsubsection]
\newtheorem{pr}{Proposition}[subsection]
\newtheorem{rmq}{Remarque}[subsubsection]
% }}}

% {{{ AUTRES -- NUMÉROTATION CLASSIQUE
\newtheorem{nnote}{Note}
\newtheorem{npr}{Proposition}
\newtheorem{nrmq}{Remarque}
% }}}

% {{{ AUTRES -- NON NUMÉROTÉS
\newtheorem*{note*}{Note}
\newtheorem*{pr*}{Proposition}
\newtheorem*{rmq*}{Remarque}
% }}}

% {{{ EXEMPLES
\newtheorem*{ex}{Exemple}
\newtheorem*{exo}{Exercice}
\newtheorem*{rappel}{Rappel}
% }}}
% }}}

% {{{ OPÉRATEURS MATHÉMATIQUES
\DeclareMathOperator{\poly}{\textbf{poly}}
\DeclareMathOperator{\gap}{\mbox{gap}}
\DeclareMathOperator{\Bg}{\mbox{Big}}
\DeclareMathOperator{\Sml}{\mbox{Sml}}
\DeclareMathOperator{\Diff}{\mbox{Diff}}
\DeclareMathOperator{\card}{\mbox{Card}}
\DeclareMathOperator{\Obj}{\mbox{Obj}}
\DeclareMathOperator{\concat}{\bullet}
\DeclareMathOperator{\sig}{\mbox{Sig}}
\DeclareMathOperator{\ver}{\mbox{Ver}}
\DeclareMathOperator{\dist}{\mbox{dist}}
\DeclareMathOperator{\bw}{\mbox{branchwidth}}
\DeclareMathOperator{\tw}{\mbox{tw}}
\DeclareMathOperator{\lm}{\leq_m}
\DeclareMathOperator{\lc}{\leq_c}
\DeclareMathOperator{\lex}{\mbox{lex}}
\DeclareMathOperator{\ord}{\mbox{ord}}
% }}}

% {{{ MACCROS
% {{{ MACROS DIVERSES
\newcommand{\npc}{$NP-$complet}
\newcommand{\npd}{$NP-$difficile}
\newcommand{\la}{largeur arborescente}
\newcommand{\legendre}[2]{\left ( \frac{#1}{#2} \right )}
\newcommand{\wqo}[0]{\emph{well-quasi-ordered}}
\newcommand{\Tau}[0]{\mathcal{T} = (T, \{X_t : t \in T\})}
\newcommand{\Taug}[0]{\mathcal{T}_G = (T, \{X_t : t \in T\})}
\newcommand{\Taustar}[0]{\mathcal{T}^* = (T, \{X_t : t \in T\})}
\newcommand{\Taugstar}[0]{\mathcal{T}_G^* = (T, \{X_t : t \in T\})}
\newcommand{\pdsol}[1]{(X_{#1}^0, X_{#1}^1, X_{#1}^2, M_{#1})}
% }}}
                
% {{{ NOM DE PROBLEMES
\newcommand{\hcycle}{\textsc{HAMILTONIAN CYCLE} }
\newcommand{\phcycle}[1]{\textsc{HAMILTONIAN CYCLE }paramétré par \textsc{#1} }
\newcommand{\vcover}{\textsc{VERTEX COVER} }
\newcommand{\twidth}{\textsc{TREE WIDTH} }
\newcommand{\wiset}{\textsc{WEIGHTED INDEPENDANT SET} }
\newcommand{\fvset}{\textsc{FEEDBACK VERTEX SET} }
\newcommand{\kvcover}{\textsc{K-Vertex Cover} }
\newcommand{\lpath}{\textsc{Longest Path} }
\newcommand{\fisched}{\textsc{Flexible Interval Scheduling} }
\newcommand{\fischedpi}{\textsc{Decision Flexible Interval Scheduling} }

% }}}

% {{{ MISE EN PAGE

\newcommand{\dfopt}[3]{
    ~\\
    \hrule
    \begin{npb}
        #1
        \begin{itemize}
            \itemindent 5mm
            \item[\textbf{Données :}] #2
            \item[\textbf{Résultat :}] #3
        \end{itemize}
    \end{npb}
    \hrule
    ~\\
}

\newcommand{\dfpb}[3]{
    ~\\
    \hrule
    \begin{npb}
        #1
        \begin{itemize}
            \itemindent 10mm
            \item[\textbf{Données :}] #2
            \item[\textbf{Question :}] #3
        \end{itemize}
    \end{npb}
    \hrule
    ~\\
}

\newcommand{\dfpbp}[4]{
    ~\\
    \hrule
    \begin{npb}
        #1
        \begin{itemize}
            \itemindent 10mm
            \item[\textbf{Données :}] #2
            \item[\textbf{Paramètre :}] #4
            \item[\textbf{Question :}] #3
        \end{itemize}
    \end{npb}
    \hrule
    ~\\
}
% }}}

% }}}
    
% {{{ TIKZ
%%% {{{ STYLE
\tikzstyle{edge}=[
	-,
	draw=black
]

\tikzstyle{sized}=[
    minimum width=9mm
]

\tikzstyle{tvertex}=[
	node distance=15mm,
    inner sep = 1mm
]

\tikzstyle{tvert}=[
	node distance=5mm,
    inner sep=1mm
]

\tikzstyle{tmvertex}=[
    tvertex,
    sized
]

\tikzstyle{tmvert}=[
    tvert,
    sized
]

\tikzstyle{mvertex}=[
    tmvertex,
	circle,
	draw=black,
	fill=black!50
]

\tikzstyle{mvert}=[
    tmvert,
	circle,
	draw=black,
	fill=black!50
]

\tikzstyle{vertex}=[
    tvertex,
	circle,
	draw=black,
	fill=black!50
]

\tikzstyle{vert}=[
    tvert,
	circle,
	draw=black,
	fill=black!50
]

\tikzstyle{treedec}=[
	vertex,
	node distance=15mm,
	draw=red,
	fill=red!50
]

\tikzstyle{treeedge}=[
	edge,
	draw=red
]

\tikzstyle{giedge}=[
	edge,
	draw=blue
]

\tikzstyle{bounding}=[
	thick, %ultra
	%dash pattern=on 1mm off 1mm,
	densely dotted,
	fill=blue!10,
	draw=blue!70
]

\tikzstyle{patate}=[
    rounded corners=5pt,
    draw=black,
    fill=black!50,
    text width=12mm,
    text centered
]

\tikzstyle{patatoid}=[
    ellipse,
    node distance=10mm,
    draw=black
]
%%% }}}

% {{{ DESSINS
\newcommand{\base}[4]{
    \draw[->] (0,0) to (0, #1);
    \draw[->] (0,0) to (#2, 0);
    
    \node at (0, #1+2) {#3};
    \node at (#2 + 2, -2) {#4};
}
% }}}
%}}}

% {{{ Ordonnacement
% {{{ Nombre fixé de machines
\newenvironment{ordo}[4][12]
% 1 : Longueur Max en cm
% 2 : Nbre de machines
% 3 : Pas en abscisse
% 4 : xmax
{
    \begin{center}
    \begin{tikzpicture}[>=latex]
        \pgfmathparse{#3/#4 * #1} \let\xpas\pgfmathresult
        \pgfmathparse{int(#4/#3)} \let\nbpas\pgfmathresult
        \pgfmathparse{\xpas/#3} \let\unitxpas\pgfmathresult
        
        \draw[thick] (#1+1,0) -- (0,0) -- (0,#2) -- (#1+1,#2);

        \node[below] at (0, 0) {$0$};

        \foreach \x in {1,...,\nbpas}{
            \pgfmathparse{\x * \xpas} \let\abscisse\pgfmathresult
            \pgfmathparse{int(\x * #3)} \let\xlabel\pgfmathresult

            \node[below] at (\abscisse, 0) {$\xlabel$};
            \draw[dotted] (\abscisse,0) to (\abscisse,#2);
        }

        \foreach \y in {1,...,#2}{
            \pgfmathparse{\y - 0.5} \let\ordlabel\pgfmathresult

            \node[left] at (0, \ordlabel) {$M_\y$};
            \draw[dotted] (0, \y) to (#1+1, \y);
        }
}
{\end{tikzpicture}\end{center}}
% }}}

% {{{ k machines k non fixé
\newenvironment{ordok}[4][12]
% 1 : Max
% 2 : Nbre de machines avant ...
% 3 : Pas en abscisse
% 4 : xmax
{
    \begin{center}
    \begin{tikzpicture}[>=latex]
        \pgfmathparse{#3/#4 * #1} \let\xpas\pgfmathresult
        \pgfmathparse{int(#4/#3)} \let\nbpas\pgfmathresult
        \pgfmathparse{\xpas/#3} \let\unitxpas\pgfmathresult
        
        \draw[thick] (#1+1,0) -- (0,0) -- (0,#2+2) -- (#1+1,#2+2);

        \node[below] at (0, 0) {$0$};

        \foreach \x in {1,...,\nbpas}{
            \pgfmathparse{\x * \xpas} \let\abscisse\pgfmathresult
            \pgfmathparse{int(\x * #3)} \let\xlabel\pgfmathresult

            \node[below] at (\abscisse, 0) {$\xlabel$};
            \draw[dotted] (\abscisse,0) to (\abscisse,#2);
            \draw[dotted] (\abscisse,#2+1) to (\abscisse,#2+2);
        }

        \foreach \y in {1,...,#2}{
            \pgfmathparse{\y - 0.5} \let\ordlabel\pgfmathresult

            \node[left] at (0, \ordlabel) {$M_\y$};
            \draw[dotted] (0, \y) to (#1+1, \y);
        }

        \node[left] at (0, #2 + 0.6) {$\vdots$};
        \node[left] at (0, #2 + 1.5) {$k$};
        \draw[dotted]  (0, #2 + 1) to (#1+1, #2 + 1);
}
{\end{tikzpicture}\end{center}}
% }}}

% TODO Vérifier que le nombre de machines est suffisant
\newcommand{\newtask}[4]{
    % 1 : Durée de la tâche
    % 2 : Numéro de machine
    % 3 : Date de début
    % 4 : Label de la tâche
    \pgfmathparse{#3*\unitxpas} \let\initx\pgfmathresult
    \pgfmathparse{#2-0.9}       \let\inity\pgfmathresult
    \pgfmathparse{#1*\unitxpas} \let\longx\pgfmathresult

    \fill[black!30] (\initx, \inity) rectangle +(\longx, 0.8);
    \node at (\initx + \longx/2, \inity + 0.4) {#4};
}

\newcommand{\newresa}[3]{
    % 1 : Durée de la réservation
    % 2 : Numéro de machine
    % 3 : Date de début
    \pgfmathparse{#3*\unitxpas} \let\initx\pgfmathresult
    \pgfmathparse{#2-0.9}       \let\inity\pgfmathresult
    \pgfmathparse{#1*\unitxpas} \let\longx\pgfmathresult

    \fill[black] (\initx, \inity) rectangle +(\longx, 0.8);
}

\newcommand{\newlabeledresa}[4]{
    % 1 : Durée de la réservation
    % 2 : Numéro de machine
    % 3 : Date de début
    % 4 : Label de la réservation
    \pgfmathparse{#3*\unitxpas} \let\initx\pgfmathresult
    \pgfmathparse{#2-0.9}       \let\inity\pgfmathresult
    \pgfmathparse{#1*\unitxpas} \let\longx\pgfmathresult

    \fill[black] (\initx, \inity) rectangle +(\longx, 0.8);
    \node[white] at (\initx + \longx/2, \inity + 0.4) {#4};
}

\newcommand{\newhole}[4]{
    % 1 : Durée du trou
    % 2 : Numéro de machine
    % 3 : Date de début
    % 4 : Label du trou
    \pgfmathparse{#3*\unitxpas} \let\initx\pgfmathresult
    \pgfmathparse{#2-0.7}       \let\inity\pgfmathresult
    \pgfmathparse{#1*\unitxpas} \let\longx\pgfmathresult

    \draw[<->] (\initx, \inity) to node[above] {#4} (\initx + \longx, \inity);
}

\newcommand{\newbeghole}[3]{
    % 1 : Durée du trou
    % 2 : Numéro de machine
    % 3 : Label du trou
    \pgfmathparse{0*\unitxpas} \let\initx\pgfmathresult
    \pgfmathparse{#2-0.7}       \let\inity\pgfmathresult
    \pgfmathparse{#1*\unitxpas} \let\longx\pgfmathresult

    \draw[->] (\initx, \inity) to node[above] {#3} (\initx + \longx, \inity);
}

\newcommand{\newendhole}[4]{
    % 1 : Durée du trou
    % 2 : Numéro de machine
    % 3 : Date de début
    % 4 : Label du trou
    \pgfmathparse{#3*\unitxpas} \let\initx\pgfmathresult
    \pgfmathparse{#2-0.7}       \let\inity\pgfmathresult
    \pgfmathparse{#1*\unitxpas} \let\longx\pgfmathresult

    \draw[<-] (\initx, \inity) to node[above] {#4} (\initx + \longx, \inity);
}

% {{{ Notations
%% Début d'une tâche
\newcommand{\st}[1]{ r^t_{#1} }
%% Fin d'une tâche
\newcommand{\ct}[1]{ \widetilde{d}^t_{#1} }
%% Durée d'une tâche
\newcommand{\pt}[1]{ p^t_{#1} }

%% Début d'une réservation
\newcommand{\sres}[1]{ r^r_{#1} }
%% Fin d'une réservation
\newcommand{\cres}[1]{ \widetilde{d}^r_{#1} }
%% Durée d'une réservation
\newcommand{\pres}[1]{ p^r_{#1} }

%% Début d'un trou
\newcommand{\sho}[1]{ r^h_{#1} }
%% Fin d'un trou
\newcommand{\cho}[1]{ \widetilde{d}^h_{#1} }
%% Durée d'un trou
\newcommand{\pho}[1]{ p^h_{#1} }

%% Début d'un événement général (tache ou réservation)
\newcommand{\sgen}[1]{ r_{#1} }
%% Fin d'un événement général
\newcommand{\cgen}[1]{ \widetilde{d}_{#1} }
%% Durée d'un événement général
\newcommand{\pgen}[1]{ p_{#1} }

% }}}

% }}}
